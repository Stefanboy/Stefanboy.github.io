<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          MySQL安装部署 - Stefanboy | Blog
        
    </title>

    <link rel="canonical" href="http://yoursite.com/article/mysql/mysqlinstall/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">

    <link rel="stylesheet" href="/css/donate.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/article_header/article_header.png')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#MySQL" title="MySQL">MySQL</a>
                            
                        </div>
                        <h1>MySQL安装部署</h1>
                        <h2 class="subheading">How to install MySQL</h2>
                        <span class="meta">
                            Posted by Stefanboy on
                            2016-11-23
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">StefanboyBlog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h2 id="欢迎来到stefanboy的博客感谢大家对我的支持">欢迎来到Stefanboy的博客，感谢大家对我的支持.</h2>
<h2 id="mysql安装配置">MySQL安装配置</h2>
<h3 id="上传tar包到uarlocal目录下">上传tar包到/uar/local目录下</h3>
<pre><code>[root@JD ~]# cd /usr/local
[root@JD local]# ll
total 43856
-rw-r--r--  1 root root 44908544 Nov 22 23:56 mysql-5.6.23-linux-glibc2.5-x86_64.tar.gz
</code></pre>
<h3 id="查看系统中是否有老的mysql进程和rpm文件">查看系统中是否有老的mysql进程和rpm文件</h3>
<pre><code>[root@JD local]# ps -ef |grep mysqld
root     17081 16006  0 16:52 pts/0    00:00:00 grep --color=auto mysqld
[root@JD local]# rpm -qa |grep mysql
[root@JD local]# rpm -qa |grep -i mysql 
[root@JD local]# 
</code></pre>
<h3 id="解压并建立软连接">解压并建立软连接</h3>
<p>软连接(在相同路径下可以写相对路径，建议还是写绝对路径)</p>
<pre><code>[root@JD local]# tar -zxvf mysql-5.6.23-linux-glibc2.5-x86_64.tar.gz 
[root@JD local]# ln -s  mysql-5.6.23-linux-glibc2.5-x86_64 mysql     
[root@JD local]# ll
lrwxrwxrwx   1 root root        34 Nov 23 17:21 mysql -&gt; mysql-5.6.23-linux-glibc2.5-x86_64
drwxr-xr-x  13 root root      4096 Nov 23 17:19 mysql-5.6.23-linux-glibc2.5-x86_64
-rw-r--r--   1 root root 311771412 Nov 23 17:18 mysql-5.6.23-linux-glibc2.5-x86_64.tar.gz
</code></pre>
<h3 id="创建用户和用户组">创建用户和用户组</h3>
<pre><code>创建组名为dba id为101的组
[root@JD local]# groupadd -g 101 dba
[root@JD local]# id dba
id: dba: no such user
创建用户mysqladmin 并且制定id为514 主组为dba 附加组为root 家目录为/usr/local/mysql
[root@JD local]# useradd -u 514 -g dba -G root -d /usr/local/mysql mysqladmin
useradd: warning: the home directory already exists.
Not copying any file from skel directory into it.
查看用户
[root@JD local]# id mysqladmin
uid=514(mysqladmin) gid=101(dba) groups=101(dba),0(root)
切换用户发现样式丢失
[root@JD local]# su - mysqladmin
-bash-4.2$ exit
logout
修复样式
[root@JD local]# cp /etc/skel/.* /usr/local/mysql/
cp: omitting directory ‘/etc/skel/.’
cp: omitting directory ‘/etc/skel/..’
[root@JD local]# su - mysqladmin
Last login: Sat Nov 23 17:34:56 CST 2019 on pts/1
[mysqladmin@JD ~]$ exit
</code></pre>
<p>组的选项</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-f,--force 如果指定的组已经存在，此选项将失明了仅以成功状态退出。当与-g一起使用，并且指定的GID_MIN已经存在时，选择另一个唯一的GID（即-g关闭）。</span><br><span class="line">-g,--gid GID 这个值必须是唯一的，除非使用-o选项。但必须是非负的。默认值是使用大于或等于GID_MIN的最小值，并且大于每个其他组。</span><br><span class="line">-K,--key KEY=VALUE 重写/etc/login.defs默认值（GID_MIN，GID_MAX和其他）。可以指定多个K选项。示例：-K GID_MIN=<span class="number">100</span> –KGID_MAX=<span class="number">499</span>。注意：-K GID_MIN=<span class="number">10</span>,GID_MAX=<span class="number">499</span>不能工作。</span><br><span class="line">-o,--non-unique 此选项允许添加一个非唯一的GID值。</span><br><span class="line">-p,--password PASSWORD 为新组使用此加密过的密码。默认为禁用密码。注意：不推荐使用这个选项，因为密码（或加密过的密码）会被用户通过列出这个过程而看到。您应该确保密码符合系统的密码政策。</span><br><span class="line">-r,--system 创建一个系统组。新的系统组数字标识符在SYS_GID_MIN到SYS_GID_MAX范围内选择，定义在login.defs中而不是GID_MIN到GID_MAX。</span><br><span class="line">-R,--root CHROOT_DIR 将修改应用到CHROOT_DIR目录，并使用配置。</span><br></pre></td></tr></table></figure>
<p>用户的选项</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-d,--home-dir HOME_DIR　　创建新用户时，用HOME_DIR作为用户主目录。默认情况是将用户名附加到BASE_DIR（默认/home/）并将其用作主目录名称。</span><br><span class="line"></span><br><span class="line">　　-m,--create-home　　其实这是一个临时开关，表示如果不存在用户主目录，则生成用户主目录（/home/[用户名]），骨架目录中的文件和目录（可以使用-k选项指定）将会被复制到主目录。默认上，如果没有指定此选项，并且/etc/login.defs（CREATE_HOME）的系统设置没有启用，则不会创建主目录。创建用户主目录必须存在且具有适当的SELinux环境和权限。否则无法创建或访问用户的主目录。</span><br><span class="line"></span><br><span class="line">　　-M,--no-create-home　　和-m选项一样是一个临时开关，即使/etc/login.defs（CREATE_HOME）的系统设置是yes，也不创建用户的主目录。</span><br><span class="line"></span><br><span class="line">　　-g,--gid GROUP　　用户初始登录组的组名或号码。组名必须已存在，组号码必须指代已存在的组。如果没有指定，useradd的行为将会依赖于/etc/login.defs文件中的USERGROUPS_ENAB参数。如果此参数设置为yes（或在命令行上指定了-U/--user-group），将会为用户创建一个组，组名和登录名相同。如果选项设置为no（或在命令行上指定-N/--no-user-group），useradd会把新用户的主组设置为/etc/<span class="keyword">default</span>/useradd中GROUP变量指定的值，再或者默认<span class="number">100</span>。</span><br><span class="line"></span><br><span class="line">　　-G,--groups GROUP1[,GROUP2,…[GROUPN]]　　用户还属于的附加组列表。每个组都用逗号隔开，中间没有空格。这里的组受到-g选项给定的组同样的限制。默认上，用户只属于初始组。（一个用户只允许有一个主组，可以有多个附加组）</span><br><span class="line"></span><br><span class="line">　　-s,--shell SHELL　　用户登录shell名。默认为留空，让系统根据/etc/<span class="keyword">default</span>/useradd中的SHELL变量选择默认的登录shell，默认为空字符串。有时需要禁止某些用户执行登录动作，例如用来执行系统服务的用户，这时将shell设置为/sbin/nologin就可以禁止用户登录。</span><br><span class="line"></span><br><span class="line">	-u,--uid UID　　用户ID的数字值。此值必须为唯一的，除非使用了-o选项。此值必须非负，默认使用大于等于UID_MIN，且大于任何其他用户ID最小值。</span><br></pre></td></tr></table></figure>
<h3 id="创建mycnf文件并修改权限-修改所属用户名和组">创建my.cnf文件并修改权限、修改所属用户名和组</h3>
<pre><code>修改之前可以先备份下
[root@JD local]# cp /etc/my.cnf /etc/my.cnf2191123
修改文件内容
[root@JD local]# vi /etc/my.cnf
[client]
port            = 3306
socket          = /usr/local/mysql/data/mysql.sock

[mysqld]
port            = 3306
socket          = /usr/local/mysql/data/mysql.sock

skip-external-locking
key_buffer_size = 256M
sort_buffer_size = 2M
read_buffer_size = 2M
read_rnd_buffer_size = 4M
query_cache_size= 32M
max_allowed_packet = 16M
myisam_sort_buffer_size=128M
tmp_table_size=32M

table_open_cache = 512
thread_cache_size = 8
wait_timeout = 86400
interactive_timeout = 86400
max_connections = 600

# Try number of CPU's*2 for thread_concurrency
thread_concurrency = 32

#isolation level and default engine 
default-storage-engine = INNODB
transaction-isolation = READ-COMMITTED

server-id  = 1
basedir     = /usr/local/mysql
datadir     = /usr/local/mysql/data
pid-file     = /usr/local/mysql/data/hostname.pid

#open performance schema
log-warnings
sysdate-is-now

binlog_format = MIXED
log_bin_trust_function_creators=1
log-error  = /usr/local/mysql/data/hostname.err
log-bin=/usr/local/mysql/arch/mysql-bin
#other logs
#general_log =1
#general_log_file  = /usr/local/mysql/data/general_log.err
#slow_query_log=1
#slow_query_log_file=/usr/local/mysql/data/slow_log.err

#for replication slave
#log-slave-updates 
#sync_binlog = 1

#for innodb options 
innodb_data_home_dir = /usr/local/mysql/data/
innodb_data_file_path = ibdata1:500M:autoextend
innodb_log_group_home_dir = /usr/local/mysql/arch
innodb_log_files_in_group = 2
innodb_log_file_size = 200M

innodb_buffer_pool_size = 2048M
innodb_additional_mem_pool_size = 50M
innodb_log_buffer_size = 16M

innodb_lock_wait_timeout = 100
#innodb_thread_concurrency = 0
innodb_flush_log_at_trx_commit = 1
innodb_locks_unsafe_for_binlog=1

#innodb io features: add for mysql5.5.8
performance_schema
innodb_read_io_threads=4
innodb-write-io-threads=4
innodb-io-capacity=200
#purge threads change default(0) to 1 for purge
innodb_purge_threads=1
innodb_use_native_aio=on

#case-sensitive file names and separate tablespace
innodb_file_per_table = 1
lower_case_table_names=1

[mysqldump]
quick
max_allowed_packet = 16M

[mysql]
no-auto-rehash

[mysqlhotcopy]
interactive-timeout

[myisamchk]
key_buffer_size = 256M
sort_buffer_size = 256M
read_buffer = 2M
write_buffer = 2M

修改用户和用户组权限
[root@JD local]# chown mysqladmin:dba /etc/my.cnf
赋640权限
[root@JD local]# chmod 640 /etc/my.cnf
修改完查看
[root@JD local]# ll /etc
-rw-r-----   1 mysqladmin dba    2218 Nov 23 17:43 my.cnf
</code></pre>
<h3 id="修改软连接文件夹和原文件夹权限">修改软连接文件夹和原文件夹权限</h3>
<pre><code>修改软连接文件夹的用户和用户组权限
[root@JD local]# chown -R mysqladmin:dba /usr/local/mysql
[root@JD local]# chown -R mysqladmin:dba /usr/local/mysql/*
修改原文件夹的用户和用户组权限
[root@JD local]# chown -R mysqladmin:dba /usr/local/mysql-5.6.23-linux-glibc2.5-x86_64
查看是否修改成功
[root@JD local]# ll
total 304472
lrwxrwxrwx   1 mysqladmin dba         34 Nov 23 17:21 mysql -&gt; mysql-5.6.23-linux-glibc2.5-x86_64
drwxr-xr-x  13 mysqladmin dba       4096 Nov 23 17:36 mysql-5.6.23-linux-glibc2.5-x86_64
[root@JD mysql]# ll
total 148
drwxr-xr-x  2 mysqladmin dba   4096 Nov 23 17:19 bin
-rw-r--r--  1 mysqladmin dba  17987 Jan 19  2015 COPYING
drwxr-xr-x  3 mysqladmin dba     17 Nov 23 17:19 data
drwxr-xr-x  2 mysqladmin dba     52 Nov 23 17:19 docs
drwxr-xr-x  3 mysqladmin dba   4096 Nov 23 17:19 include
-rw-r--r--  1 mysqladmin dba 102315 Jan 19  2015 INSTALL-BINARY
drwxr-xr-x  3 mysqladmin dba   4096 Nov 23 17:19 lib
drwxr-xr-x  4 mysqladmin dba     28 Nov 23 17:19 man
drwxr-xr-x 10 mysqladmin dba   4096 Nov 23 17:19 mysql-test
-rw-r--r--  1 mysqladmin dba   2496 Jan 19  2015 README
drwxr-xr-x  2 mysqladmin dba     29 Nov 23 17:19 scripts
drwxr-xr-x 28 mysqladmin dba   4096 Nov 23 17:19 share
drwxr-xr-x  4 mysqladmin dba   4096 Nov 23 17:19 sql-bench
drwxr-xr-x  2 mysqladmin dba    130 Nov 23 17:19 support-files
[root@JD mysql]# 
[root@JD mysql]# cd ../
[root@JD local]# cd mysql-5.6.23-linux-glibc2.5-x86_64 
[root@JD mysql-5.6.23-linux-glibc2.5-x86_64]# ll
total 148
drwxr-xr-x  2 mysqladmin dba   4096 Nov 23 17:19 bin
-rw-r--r--  1 mysqladmin dba  17987 Jan 19  2015 COPYING
drwxr-xr-x  3 mysqladmin dba     17 Nov 23 17:19 data
drwxr-xr-x  2 mysqladmin dba     52 Nov 23 17:19 docs
drwxr-xr-x  3 mysqladmin dba   4096 Nov 23 17:19 include
-rw-r--r--  1 mysqladmin dba 102315 Jan 19  2015 INSTALL-BINARY
drwxr-xr-x  3 mysqladmin dba   4096 Nov 23 17:19 lib
drwxr-xr-x  4 mysqladmin dba     28 Nov 23 17:19 man
drwxr-xr-x 10 mysqladmin dba   4096 Nov 23 17:19 mysql-test
-rw-r--r--  1 mysqladmin dba   2496 Jan 19  2015 README
drwxr-xr-x  2 mysqladmin dba     29 Nov 23 17:19 scripts
drwxr-xr-x 28 mysqladmin dba   4096 Nov 23 17:19 share
drwxr-xr-x  4 mysqladmin dba   4096 Nov 23 17:19 sql-bench
drwxr-xr-x  2 mysqladmin dba    130 Nov 23 17:19 support-files
[root@JD mysql-5.6.23-linux-glibc2.5-x
为原文件夹和软连接文件夹赋权限
[root@JD local]# chmod -R 755 /usr/local/mysql 
[root@JD local]# chmod -R 755 /usr/local/mysql/*
[root@JD local]# chmod -R 755 /usr/local/mysql-5.6.23-linux-glibc2.5-x86_64
</code></pre>
<h3 id="切换用户准备安装">切换用户准备安装</h3>
<pre><code>切换用户
[root@JD local]# su - mysqladmin
[mysqladmin@JD ~]$ pwd
/usr/local/mysql
arch存放binlog文件 backup存放恢复文件（本次安装没有用到）
[mysqladmin@JD ~]$ mkdir arch backup
使用mysqladmin进行安装 初始目录/usr/local/mysql 数据目录data，发现缺依赖

[mysqladmin@JD ~]$ scripts/mysql_install_db  \
&gt; --user=mysqladmin \
&gt; --basedir=/usr/local/mysql \
&gt; --datadir=/usr/local/mysql/data 

-bash: scripts/mysql_install_db: /usr/bin/perl: bad interpreter: No such file or directory

切回到root用户，安装依赖
[mysqladmin@JD ~]$ exit
logout
[root@JD local]# yum install -y perl

再次使用mysqladmin用户安装，还是缺依赖

[mysqladmin@JD ~]$ scripts/mysql_install_db  --user=mysqladmin --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data 

FATAL ERROR: please install the following Perl modules before executing scripts/mysql_install_db:
Data::Dumper

切回到root用户，安装依赖
[mysqladmin@JD ~]$ exit
logout
[root@JD local]# yum install -y autoconf

再次使用mysqladmin用户安装，还是缺依赖
[mysqladmin@JD ~]$ scripts/mysql_install_db  --user=mysqladmin --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data 

[mysqladmin@JD ~]$ scripts/mysql_install_db  --user=mysqladmin --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data 

Installing MySQL system tables.../usr/local/mysql/bin/mysqld: error while loading shared libraries: libaio.so.1: cannot open shared object file: No such file or directory

切回到root用户，安装依赖
[mysqladmin@JD ~]$ exit
logout
[root@JD local]# yum install -y libaio

再次使用mysqladmin用户安装，安装成功

[mysqladmin@JD ~]$ scripts/mysql_install_db  --user=mysqladmin --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data 

Installing MySQL system tables...2019-11-23 18:11:27 0 [Warning] 'THREAD_CONCURRENCY' is deprecated and will be removed in a future release.
2019-11-23 18:11:27 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details).
OK

Filling help tables...2019-11-23 18:11:43 0 [Warning] 'THREAD_CONCURRENCY' is deprecated and will be removed in a future release.
2019-11-23 18:11:43 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details).
OK

To start mysqld at boot time you have to copy
support-files/mysql.server to the right place for your system

PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !
To do so, start the server, then issue the following commands:

  /usr/local/mysql/bin/mysqladmin -u root password 'new-password'
  /usr/local/mysql/bin/mysqladmin -u root -h JD password 'new-password'

Alternatively you can run:

  /usr/local/mysql/bin/mysql_secure_installation

which will also give you the option of removing the test
databases and anonymous user created by default.  This is
strongly recommended for production servers.

See the manual for more instructions.

You can start the MySQL daemon with:

  cd . ; /usr/local/mysql/bin/mysqld_safe &amp;

You can test the MySQL daemon with mysql-test-run.pl

  cd mysql-test ; perl mysql-test-run.pl

Please report any problems at http://bugs.mysql.com/

The latest information about MySQL is available on the web at

  http://www.mysql.com

Support MySQL by buying support/licenses at http://shop.mysql.com

WARNING: Found existing config file /usr/local/mysql/my.cnf on the system.
Because this file might be in use, it was not replaced,
but was used in bootstrap (unless you used --defaults-file)
and when you later start the server.
The new default config file was created as /usr/local/mysql/my-new.cnf,
please compare it with your file and take the changes you need.

WARNING: Default config file /etc/my.cnf exists on the system
This file will be read by default by the MySQL server
If you do not want to use this, either remove it, or use the
--defaults-file argument to mysqld_safe when starting the server
</code></pre>
<h3 id="配置服务并且启动">配置服务并且启动</h3>
<pre><code>切换root用户
[mysqladmin@JD ~]$ exit
logout
[root@JD local]# cd /usr/local/mysql
[root@JD mysql]# ll
将服务文件拷贝到init.d下，并重命名为mysql
[root@JD mysql]# cp support-files/mysql.server /etc/rc.d/init.d/mysql
赋予可执行权限
[root@JD mysql]# chmod +x /etc/rc.d/init.d/mysql
如果部署过就先删除服务，第一次部署就添加服务
[root@JD mysql]# chkconfig --del mysql
[root@JD mysql]# chkconfig --add mysql
配置开启自启动，当然了，配置了也不生效，只能自己写个脚本
[root@JD mysql]# chkconfig --level 345 mysql on
[root@JD mysql]# vi /etc/rc.local 


#!/bin/bash
# THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES
#
# It is highly advisable to create own systemd services or udev rules
# to run scripts during boot instead of using this file.
#
# In contrast to previous versions due to parallel execution during boot
# this script will NOT be run after all other services.
#
# Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure
# that this script will be executed during boot.

touch /var/lock/subsys/local
su - mysqladmin -c &quot;/etc/init.d/mysql start --federated&quot;

切换用户
[root@JD mysql]# su - mysqladmin
Last login: Sat Nov 23 18:06:34 CST 2019 on pts/1
[mysqladmin@JD ~]$ ll
total 156
drwxr-xr-x  2 mysqladmin dba    110 Nov 23 18:11 arch
drwxr-xr-x  2 mysqladmin dba      6 Nov 23 18:01 backup
drwxr-xr-x  2 mysqladmin dba   4096 Nov 23 17:19 bin
-rwxr-xr-x  1 mysqladmin dba  17987 Jan 19  2015 COPYING
drwxr-xr-x  5 mysqladmin dba     87 Nov 23 18:11 data
drwxr-xr-x  2 mysqladmin dba     52 Nov 23 17:19 docs
drwxr-xr-x  3 mysqladmin dba   4096 Nov 23 17:19 include
-rwxr-xr-x  1 mysqladmin dba 102315 Jan 19  2015 INSTALL-BINARY
drwxr-xr-x  3 mysqladmin dba   4096 Nov 23 17:19 lib
drwxr-xr-x  4 mysqladmin dba     28 Nov 23 17:19 man
-rw-r--r--  1 mysqladmin dba    943 Nov 23 18:09 my.cnf
-rw-r--r--  1 mysqladmin dba    943 Nov 23 18:11 my-new.cnf
drwxr-xr-x 10 mysqladmin dba   4096 Nov 23 17:19 mysql-test
-rwxr-xr-x  1 mysqladmin dba   2496 Jan 19  2015 README
drwxr-xr-x  2 mysqladmin dba     29 Nov 23 17:19 scripts
drwxr-xr-x 28 mysqladmin dba   4096 Nov 23 17:19 share
drwxr-xr-x  4 mysqladmin dba   4096 Nov 23 17:19 sql-bench
drwxr-xr-x  2 mysqladmin dba    130 Nov 23 17:19 support-files

删除这俩文件，因为我们用的是/etc/my.cnf文件启动的
[mysqladmin@JD ~]$ rm -rf my.cnf my-new.cnf 
启动mysql服务
[mysqladmin@JD ~]$ service mysql start
Starting MySQL. SUCCESS! 
进入mysql（mysql5.6是初始密码是没有的，mysql5.7是有默认密码的）

[mysqladmin@JD ~]$ mysql -uroot -p

Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1
Server version: 5.6.23-log MySQL Community Server (GPL)

Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
</code></pre>
<h3 id="mysql启动后的操作">mysql启动后的操作</h3>
<p>进入mysql后，设置root用户新密码，删除空密码，然后修改完后一定要执行flush privileges;进行权限的刷新</p>
<pre><code>登录mysql，查看库（有四个库才算安装成功）
mysql&gt; show databaes;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'databaes' at line 1
mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| test               |
+--------------------+
4 rows in set (0.00 sec)

切库和设置root用户的新密码
mysql&gt; use mysql  
Database changed
mysql&gt; update user set password=password('mysqladmin') where user='root';
Query OK, 4 rows affected (0.00 sec)
Rows matched: 4  Changed: 4  Warnings: 0

删除空账号
mysql&gt; delete from user where user='';
Query OK, 2 rows affected (0.00 sec)
查询用户
mysql&gt; select host,user,password from user
	-&gt; ;
+-----------+------+-------------------------------------------+
| host      | user | password                                  |
+-----------+------+-------------------------------------------+
| localhost | root | *A5C34F28328751B780896836C8A565C5C130175E |
| jd        | root | *A5C34F28328751B780896836C8A565C5C130175E |
| 127.0.0.1 | root | *A5C34F28328751B780896836C8A565C5C130175E |
| ::1       | root | *A5C34F28328751B780896836C8A565C5C130175E |
+-----------+------+-------------------------------------------+
4 rows in set (0.00 sec)
刷新一下权限，使设置的密码生效
mysql&gt; flush privileges;
Query OK, 0 rows affected (0.00 sec)
</code></pre>
<h3 id="配置个人环境变量">配置个人环境变量</h3>
<pre><code>[mysqladmin@JD ~]$ vi .bashrc

export MYSQL_HOME=/usr/local/mysql
export PATH=$MYSQL_HOME/bin:$PATH
PS1=`uname -n`&quot;:&quot;'$USER'&quot;:&quot;'$PWD'&quot;:&gt;&quot;; export PS1

[mysqladmin@JD ~]$ source .bashrc
JD:mysqladmin:/usr/local/mysql:&gt;echo $MYSQL_HOME
/usr/local/mysql
JD:mysqladmin:/usr/local/mysql:&gt;which mysql
~/bin/mysql
</code></pre>
<h3 id="部署出了问题重新安装">部署出了问题，重新安装</h3>
<p>如果部署出了问题<br>
1检查执行的目录 用户<br>
2重新部署</p>
<pre><code>删除
rm -rf arch/*  #存放binlog文件
rm -rf data/*  #存放数据文件
binlog文件 数据文件

重新安装
scripts/mysql_install_db  \
--user=mysqladmin \
--basedir=/usr/local/mysql \
--datadir=/usr/local/mysql/data 
</code></pre>
<h3 id="允许外面机器各种客户端连接mysql">允许外面机器（各种客户端）连接mysql</h3>
<pre><code>允许用户root从任意ip的主机连接到mysql服务器，并使用mysqladmin作为密码
mysql&gt; grant all privileges on *.* to root@'%' identified by 'mysqladmin';
Query OK, 0 rows affected (0.00 sec)
刷新权限
mysql&gt; flush privileges;
Query OK, 0 rows affected (0.00 sec)
</code></pre>
<h2 id="配域名">配域名</h2>
<h3 id="云主机">云主机</h3>
<p>hosts文件自带的前两行一定不要删除；配置对应的是 内网ip hostname<br>
shell脚本 程序 CDH部署 统统使用hostname：查看通不通使用ping hostname</p>
<pre><code>[root@JD ~]# cat /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
</code></pre>
<h3 id="windows">windows</h3>
<p>window 访问，IDEA开发 都是外网ip （虚拟的 漂着 重启 有变化的），统一的配置hostname，配置地方为：C:\Windows\System32\drivers\etc\hosts；内容为：外网ip hostname</p>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/article/hexoinstall/" data-toggle="tooltip" data-placement="top" title="Hexo安装部署和使用">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/article/linux/linux5/" data-toggle="tooltip" data-placement="top" title="linux基本命令五">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <br>

                <!--打赏-->
                
                <!--打赏-->

                <br>
                <!--分享-->
                
                    <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                    <!--  css & js -->
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!--分享-->
                <br>                       
                
                <!-- require APlayer -->
                

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#欢迎来到stefanboy的博客感谢大家对我的支持"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">&#x6B22;&#x8FCE;&#x6765;&#x5230;Stefanboy&#x7684;&#x535A;&#x5BA2;&#xFF0C;&#x611F;&#x8C22;&#x5927;&#x5BB6;&#x5BF9;&#x6211;&#x7684;&#x652F;&#x6301;.</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#mysql安装配置"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">MySQL&#x5B89;&#x88C5;&#x914D;&#x7F6E;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#上传tar包到uarlocal目录下"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">&#x4E0A;&#x4F20;tar&#x5305;&#x5230;/uar/local&#x76EE;&#x5F55;&#x4E0B;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#查看系统中是否有老的mysql进程和rpm文件"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x4E2D;&#x662F;&#x5426;&#x6709;&#x8001;&#x7684;mysql&#x8FDB;&#x7A0B;&#x548C;rpm&#x6587;&#x4EF6;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#解压并建立软连接"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">&#x89E3;&#x538B;&#x5E76;&#x5EFA;&#x7ACB;&#x8F6F;&#x8FDE;&#x63A5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#创建用户和用户组"><span class="toc-nav-number">2.4.</span> <span class="toc-nav-text">&#x521B;&#x5EFA;&#x7528;&#x6237;&#x548C;&#x7528;&#x6237;&#x7EC4;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#创建mycnf文件并修改权限-修改所属用户名和组"><span class="toc-nav-number">2.5.</span> <span class="toc-nav-text">&#x521B;&#x5EFA;my.cnf&#x6587;&#x4EF6;&#x5E76;&#x4FEE;&#x6539;&#x6743;&#x9650;&#x3001;&#x4FEE;&#x6539;&#x6240;&#x5C5E;&#x7528;&#x6237;&#x540D;&#x548C;&#x7EC4;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#修改软连接文件夹和原文件夹权限"><span class="toc-nav-number">2.6.</span> <span class="toc-nav-text">&#x4FEE;&#x6539;&#x8F6F;&#x8FDE;&#x63A5;&#x6587;&#x4EF6;&#x5939;&#x548C;&#x539F;&#x6587;&#x4EF6;&#x5939;&#x6743;&#x9650;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#切换用户准备安装"><span class="toc-nav-number">2.7.</span> <span class="toc-nav-text">&#x5207;&#x6362;&#x7528;&#x6237;&#x51C6;&#x5907;&#x5B89;&#x88C5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#配置服务并且启动"><span class="toc-nav-number">2.8.</span> <span class="toc-nav-text">&#x914D;&#x7F6E;&#x670D;&#x52A1;&#x5E76;&#x4E14;&#x542F;&#x52A8;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#mysql启动后的操作"><span class="toc-nav-number">2.9.</span> <span class="toc-nav-text">mysql&#x542F;&#x52A8;&#x540E;&#x7684;&#x64CD;&#x4F5C;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#配置个人环境变量"><span class="toc-nav-number">2.10.</span> <span class="toc-nav-text">&#x914D;&#x7F6E;&#x4E2A;&#x4EBA;&#x73AF;&#x5883;&#x53D8;&#x91CF;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#部署出了问题重新安装"><span class="toc-nav-number">2.11.</span> <span class="toc-nav-text">&#x90E8;&#x7F72;&#x51FA;&#x4E86;&#x95EE;&#x9898;&#xFF0C;&#x91CD;&#x65B0;&#x5B89;&#x88C5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#允许外面机器各种客户端连接mysql"><span class="toc-nav-number">2.12.</span> <span class="toc-nav-text">&#x5141;&#x8BB8;&#x5916;&#x9762;&#x673A;&#x5668;&#xFF08;&#x5404;&#x79CD;&#x5BA2;&#x6237;&#x7AEF;&#xFF09;&#x8FDE;&#x63A5;mysql</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#配域名"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">&#x914D;&#x57DF;&#x540D;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#云主机"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">&#x4E91;&#x4E3B;&#x673A;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#windows"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">windows</span></a></li></ol></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#MySQL" title="MySQL">MySQL</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="" target="_blank"></a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'rz'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


<!-- chrome Firefox 中文锚点定位失效-->
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
<!-- smooth scroll behavior polyfill  -->
<script type="text/javascript" src="/js/smoothscroll.js"></script>
<script>
        $('#toc').on('click','a',function(a){
            // var isChrome = window.navigator.userAgent.indexOf("Chrome") !== -1;
            // console.log(window.navigator.userAgent,isChrome)
                // if(isChrome) {
                    // console.log(a.currentTarget.outerHTML);
                    // console.log($(a.currentTarget).attr("href"));
                    //跳转到指定锚点
                    // document.getElementById(a.target.innerText.toLowerCase()).scrollIntoView(true);
                    document.getElementById($(a.currentTarget).attr("href").replace("#","")).scrollIntoView({behavior: 'smooth' });
                // }
        })  
</script>


    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/Stefanboy">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Stefanboy 2019 
                    By <a href="#">Stefanboy</a> | BigData
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=ruozedata&repo=Bigdata&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://yoursite.com/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'xxx';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="http://yoursite.com/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
